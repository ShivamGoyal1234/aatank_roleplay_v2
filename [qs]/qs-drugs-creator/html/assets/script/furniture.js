const _0x5bc6c4=_0x3fbb;!function(){for(var n=_0x3fbb,e=_0x4ac0();;)try{if(614047==-parseInt(n(564))+-parseInt(n(631))/2*(parseInt(n(526))/3)+parseInt(n(519))/4*(parseInt(n(487))/5)+-parseInt(n(574))/6*(-parseInt(n(658))/7)+-parseInt(n(532))/8*(-parseInt(n(518))/9)+-parseInt(n(589))/10+parseInt(n(525))/11*(-parseInt(n(491))/12))break;e.push(e.shift())}catch(n){e.push(e.shift())}}();import{Post,getOwnedObjects}from"./api.js";import*as _0x34090e from"three";import{TransformControls}from"three/addons/controls/TransformControls.js";let decorateMenu=null,editable=!1,editingData={};function setDecorateMenu(n){decorateMenu=n}const tracking={x:0,y:0},objectInfos={},furniData={prevY:[],prevX:[],prevZ:[],prevPitch:[],prevRoll:[],prevYaw:[]};let isTransforming=!1,editingId=null;const degToRad=n=>{var e=_0x3fbb,t={UcNkm:function(n,e){return n*e},HjWMf:function(n,e){return n/e}};return t[e(558)](n,t[e(608)](Math.PI,180))},radToDeg=n=>{var e=_0x3fbb,t={iKLdd:function(n,e){return n*e},EvnKG:function(n,e){return n/e}};return t[e(493)](n,t[e(442)](180,Math.PI))},selectLegacyObject=async n=>{var e=_0x3fbb,t={orEIy:function(n,e){return n!=e},VWwft:function(n,e){return n==e},zDJXG:function(n){return n()},vXrHS:function(n,e){return n<e},KqXfZ:function(n,e){return n!=e}};if(t[e(650)](decorateMenu,null)&&t[e(463)](decorateMenu[e(422)],1)){var r=await t[e(459)](getOwnedObjects);if(!t[e(463)](r[decorateMenu[e(452)][e(523)+"u"][e(453)]][e(657)],n)){for(var c=null,o=0;t[e(541)](o,r[e(441)]);o++)if(t[e(463)](r[o][e(657)],n)){c=o;break}t[e(539)](c,null)&&(decorateMenu[e(452)][e(523)+"u"][e(453)]=c),decorateMenu[e(452)][e(523)+"u"][e(422)]()}}},mouseDownHandler=async n=>{var e=_0x3fbb,t={bDvxQ:function(n,e){return n&&e},bzXOf:function(n,e){return n!==e},ybgPd:e(590),PfmUl:e(560)+e(568),JceSV:e(641),zsgVk:function(n,e,t){return n(e,t)},SdzbP:e(573)+e(633),ueDGp:function(n,e){return n!=e},Miump:function(n,e){return n==e},MaKUn:function(n){return n()},BhhJc:function(n,e){return n==e},UbsYt:function(n,e){return n<e},LHMGn:function(n,e){return n==e},hxdWy:function(n){return n()},HJhvo:function(n,e){return n(e)},dZihN:e(477)+"5",uETYm:e(505)+e(509)+e(638)+e(443)+e(506)+e(524),aSvVR:e(499),UezTd:e(553),jjEKV:e(661)};if((isTransforming=t[e(476)](isTransforming,!editingId)?!1:isTransforming)||t[e(485)](n[e(619)][e(641)],t[e(527)]))return console[e(547)](t[e(635)],isTransforming,t[e(627)],n[e(619)][e(641)]);var n=tracking.x,r=tracking.y,c=await t[e(434)](Post,t[e(432)],{x:n,y:r});if(c[e(499)]&&t[e(485)](editingId,c[e(553)]))if(t[e(468)](decorateMenu,null)&&t[e(668)](decorateMenu[e(422)],1)){var o=await t[e(496)](getOwnedObjects);if(!t[e(486)](o[decorateMenu[e(452)][e(523)+"u"][e(453)]][e(657)],c[e(553)])){for(var a=null,i=0;t[e(495)](i,o[e(441)]);i++)if(t[e(604)](o[i][e(657)],c[e(553)])){a=i;break}t[e(468)](a,null)&&(decorateMenu[e(452)][e(523)+"u"][e(453)]=a),decorateMenu[e(452)][e(523)+"u"][e(422)]()}}else t[e(648)](clearData),editingId=c[e(553)],t[e(471)](changeEntity,editingId),isTransforming=!1;else if(!c[e(499)]){var u=t[e(451)][e(431)]("|");let n=0;for(;;){switch(u[n++]){case"0":transformControls[e(649)]=!1;continue;case"1":editingId=null;continue;case"2":t[e(648)](clearData);continue;case"3":console[e(547)](t[e(605)],t[e(571)],c[e(499)],t[e(450)],c[e(553)],t[e(446)],editingId);continue;case"4":if(t[e(468)](decorateMenu,null)&&t[e(668)](decorateMenu[e(422)],1))return;continue;case"5":isTransforming=!1;continue}break}}},handleTracking=(window[_0x5bc6c4(533)+_0x5bc6c4(655)](_0x5bc6c4(598),mouseDownHandler),n=>{var e=_0x5bc6c4,t={vOKLc:function(n,e){return n-e},JebOX:function(n,e){return n-e},XKVNJ:function(n,e,t){return n(e,t)},xzJJt:function(n,e,t){return n(e,t)}},r=t[e(628)](n[e(467)],n[e(619)][e(606)]),n=t[e(563)](n[e(623)],n[e(619)][e(606)]);tracking.x=t[e(458)](normalize,r,document[e(508)+e(569)][e(652)+"h"]),tracking.y=t[e(567)](normalize,n,document[e(508)+e(569)][e(662)+"ht"])}),Scene=new _0x34090e[_0x5bc6c4(591)],Renderer=new _0x34090e[_0x5bc6c4(447)+_0x5bc6c4(470)]({alpha:!0}),Camera=(Renderer[_0x5bc6c4(660)](window[_0x5bc6c4(584)],window[_0x5bc6c4(592)+"t"]),document[_0x5bc6c4(528)+_0x5bc6c4(457)](_0x5bc6c4(546))[_0x5bc6c4(444)+"d"](Renderer[_0x5bc6c4(609)]),new _0x34090e[_0x5bc6c4(636)+_0x5bc6c4(464)](50,window[_0x5bc6c4(584)]/window[_0x5bc6c4(592)+"t"],.1,1e4)),boxGeometry=(Camera[_0x5bc6c4(484)][_0x5bc6c4(427)]=_0x5bc6c4(472),new _0x34090e[_0x5bc6c4(588)+"y"](1,1,1)),meshPhongMaterial=new _0x34090e[_0x5bc6c4(621)+_0x5bc6c4(579)]({color:16711935,transparent:!0,opacity:0}),Mesh=new _0x34090e[_0x5bc6c4(601)](boxGeometry,meshPhongMaterial);Mesh[_0x5bc6c4(484)][_0x5bc6c4(427)]=_0x5bc6c4(472),Mesh[_0x5bc6c4(664)][_0x5bc6c4(640)](1,1,1),Scene[_0x5bc6c4(504)](Mesh),Renderer[_0x5bc6c4(609)][_0x5bc6c4(665)][_0x5bc6c4(473)]=_0x5bc6c4(618);let animationFrameActive=null;function renderGeometry(){var n=_0x5bc6c4;animationFrameActive={VllBW:function(n,e){return n(e)}}[n(529)](requestAnimationFrame,renderGeometry),Renderer[n(503)](Scene,Camera)}function showGeometry(){var n=_0x5bc6c4,e={keVar:n(494)+"ry",jPJnF:n(622)};console[n(547)](e[n(570)]),transformControls[n(649)]=!1,Renderer[n(609)][n(665)][n(473)]=e[n(448)]}function hideGeometry(){var n=_0x5bc6c4,e={Vkbdj:n(478)+"ry",DURQq:n(618)};console[n(547)](e[n(433)]),transformControls[n(649)]=!1,Renderer[n(609)][n(665)][n(473)]=e[n(583)]}function hideTransformControls(){var n=_0x5bc6c4,e={mcucg:n(552)+n(536)+"s"};console[n(547)](e[n(651)]),transformControls[n(649)]=!1}const transformControls=new TransformControls(Camera,Renderer[_0x5bc6c4(609)]),editEntity=(transformControls[_0x5bc6c4(533)+_0x5bc6c4(655)](_0x5bc6c4(498),()=>{var n=_0x5bc6c4,e={QGkLo:function(n,e){return n(e)},PCbGT:function(n,e){return n(e)},NOPvd:function(n,e){return n(e)},hiSQR:function(n){return n()}},t=objectInfos[editingId];Mesh[n(501)].x&&Mesh[n(501)].y&&Mesh[n(501)].z&&t&&(t.x=Mesh[n(501)].x,t.y=-Mesh[n(501)].z,t.z=Mesh[n(501)].y,t[n(599)]=e[n(426)](radToDeg,Mesh[n(484)].x),t[n(538)]=e[n(522)](radToDeg,-Mesh[n(484)].z),t[n(543)]=e[n(479)](radToDeg,Mesh[n(484)].y),e[n(517)](editEntity),Renderer[n(503)](Scene,Camera))}),()=>{var n=_0x5bc6c4,e={IhhvW:function(n,e,t){return n(e,t)},cktxf:n(425)+"y",outwS:function(n,e){return n(e)},BxXLY:function(n,e){return n(e)},erame:function(n,e){return n(e)},uHUcv:function(n,e){return n(e)}},t=objectInfos[editingId];e[n(559)](Post,e[n(512)],{id:editingId,alpha:e[n(438)](parseInt,t[n(603)]),x:e[n(669)](parseFloat,t.x),y:e[n(423)](parseFloat,t.y),z:e[n(669)](parseFloat,t.z),pitch:e[n(438)](parseFloat,t[n(599)]),roll:e[n(540)](parseFloat,t[n(538)]),yaw:e[n(423)](parseFloat,t[n(543)])}),e[n(540)](setObjectHelperValues,t)}),storeData=(transformControls[_0x5bc6c4(533)+_0x5bc6c4(655)](_0x5bc6c4(620),()=>{var n=_0x5bc6c4;isTransforming=!0,{ljpjf:function(n){return n()}}[n(454)](storeData)}),transformControls[_0x5bc6c4(533)+_0x5bc6c4(655)](_0x5bc6c4(600),()=>{var n=_0x5bc6c4,e=objectInfos[editingId];e&&(e.x=Mesh[n(501)].x,e.y=-Mesh[n(501)].z,e.z=Mesh[n(501)].y,isTransforming=!1)}),transformControls[_0x5bc6c4(440)+_0x5bc6c4(537)](.1),transformControls[_0x5bc6c4(660)](.8),transformControls[_0x5bc6c4(616)+_0x5bc6c4(645)](degToRad(15)),transformControls[_0x5bc6c4(429)](Mesh),Scene[_0x5bc6c4(504)](transformControls),()=>{var e=_0x5bc6c4,t={zWANa:function(n,e){return n!==e},ECJdv:function(n,e){return n!==e},foIZY:function(n,e){return n!==e},abFBo:e(462)+"3"},r=objectInfos[editingId];if(r&&t[e(474)](r.x,0)&&t[e(566)](r.y,0)&&t[e(615)](r.z,0)){var c=t[e(630)][e(431)]("|");let n=0;for(;;){switch(c[n++]){case"0":furniData[e(531)][e(611)](r[e(538)]);continue;case"1":furniData[e(625)][e(611)](r.x);continue;case"2":furniData[e(634)][e(611)](r[e(599)]);continue;case"3":furniData[e(548)][e(611)](r[e(543)]);continue;case"4":furniData[e(497)][e(611)](r.y);continue;case"5":furniData[e(575)][e(611)](r.z);continue}break}}});function cancelRenderGeometry(){var n=_0x5bc6c4;animationFrameActive&&({vVWbl:function(n,e){return n(e)}}[n(483)](cancelAnimationFrame,animationFrameActive),animationFrameActive=null)}function setEditMode(n){var e=_0x5bc6c4,t={Crliv:function(n,e){return n===e},oCElJ:e(488),Qfdjm:e(555)};t[e(654)](n,t[e(515)])?transformControls[e(439)](t[e(515)]):transformControls[e(439)](t[e(480)])}function setRotationSnap(n){var e=_0x5bc6c4;transformControls[e(616)+e(645)](n)}function setTranslationSnap(n){var e=_0x5bc6c4;transformControls[e(440)+e(537)](n)}const normalize=(n,e)=>{var t=_0x5bc6c4,r={PJwMf:function(n,e){return n+e},QMfso:function(n,e){return n/e},ZgAsE:function(n,e){return n*e},LquDX:function(n,e){return n-e}};return r[t(637)](r[t(596)](r[t(490)](1,r[t(456)](n,0)),r[t(456)](e,0)),0)},handleUpdatePositions=(window[_0x5bc6c4(533)+_0x5bc6c4(655)](_0x5bc6c4(534),handleTracking),n=>{var e=_0x5bc6c4,t={JineL:function(n,e){return n(e)},LgEGo:function(n,e){return n(e)},ptTsc:function(n,e,t){return n(e,t)},nDRIm:function(n,e){return n(e)},Wxoxt:function(n,e){return n(e)},tBogl:function(n,e){return n(e)}},r=(Camera[e(501)][e(640)](n[e(460)][e(501)].x,n[e(460)][e(501)].z,-n[e(460)][e(501)].y),n[e(460)][e(484)].x),c=n[e(460)][e(484)].z,o=n[e(460)][e(484)].y;Camera[e(484)][e(640)](t[e(595)](degToRad,r),t[e(632)](degToRad,t[e(461)](zRotationHandler,r,c)),t[e(632)](degToRad,o)),Camera[e(647)]=n[e(460)][e(647)],Camera[e(492)+e(435)+"ix"](),n[e(553)][e(501)]&&(Mesh[e(501)][e(640)](n[e(553)][e(501)].x,n[e(553)][e(501)].z,-n[e(553)][e(501)].y),Mesh[e(484)][e(640)](t[e(639)](degToRad,n[e(553)][e(484)].x),t[e(475)](degToRad,n[e(553)][e(484)].z),t[e(585)](degToRad,-n[e(553)][e(484)].y)))});function _0x4ac0(){const n=["ect","LquDX","tor","XKVNJ","zDJXG","cam","ptTsc","1|4|5|2|0|","VWwft","eCamera","RgZzg","ground_obj","pageX","ueDGp","DxWNh","rer","HJhvo","YZX","display","zWANa","Wxoxt","bDvxQ","3|4|2|1|0|","hideGeomet","NOPvd","Qfdjm","UUjOK","ehgIC","vVWbl","rotation","bzXOf","BhhJc","5HcPMhD","rotate","ty-z","ZgAsE","20100YUvdhu","updateProj","iKLdd","showGeomet","UbsYt","MaKUn","prevY","change","hit","ty-y","position","ftBiu","render","add","mouseDownH","transform ","lvMHP","documentEl","andler::: ","lFOKk","s not exis","cktxf","XjVRv","#object-he","oCElJ","ty-yaw","hiSQR","27FNUokB","3875720utzSUI","KdogP","NBumB","PCbGT","sortingMen","controls","517HmbKvW","796194tCljKz","ybgPd","querySelec","VllBW","EUHee","prevRoll","1109936EnmaJd","addEventLi","mousemove","AWAXp","ormControl","tionSnap","roll","KqXfZ","uHUcv","vXrHS","keydown","yaw","9|16|12|13","pLraw","#decorate","log","prevYaw","xoDvD","aMVHa","5|0","hideTransf","entity","lper #mode","translate","xsCzS","VFNhC","UcNkm","IhhvW","isTransfor","KRNLh","1|3|2|4|6|","JebOX","418154pJZoUD","1|8|10|5|4","ECJdv","xzJJt","ming","ement","keVar","aSvVR","aWizA","select_ent","5131614JxaVic","prevZ","CrJhZ","tqQPK","ata","aterial","uHZus","key","toggleCurs","DURQq","innerWidth","tBogl","l-name","toggleMous","BoxGeometr","3333050hhhUuc","CANVAS","Scene","innerHeigh","ty-roll","y_info","JineL","QMfso","load_entit","mousedown","pitch","mouseUp","Mesh","lrnIr","alpha","LHMGn","uETYm","offsetTop","|2|15|0|6|","HjWMf","domElement","ty-x","push","yhFxJ","dRjKj","diLuI","foIZY","setRotatio","val","none","target","mouseDown","MeshPhongM","block","pageY","GSrOW","prevX","BRBpj","JceSV","vOKLc","wAHDK","abFBo","6lKlTXM","LgEGo","ity","prevPitch","PfmUl","Perspectiv","PJwMf","no hit del","nDRIm","set","tagName","distance","exists","aLHat","nSnap","ty-pitch","fov","hxdWy","visible","orEIy","mcucg","scrollWidt","RMkbD","Crliv","stener","pgxup","handle","7DuobiO","eXxoU","setSize","editingId","scrollHeig","ObBzb","scale","style","changeEnti","hash","Miump","BxXLY","lper #enti","setEntityD","sort","erame","oiwIj","edit_entit","QGkLo","order","eMovement","attach","entity doe","split","SdzbP","Vkbdj","zsgVk","ectionMatr","0|2|4|5|3|","ldfES","outwS","setMode","setTransla","length","EvnKG","eting the ","appendChil","RicnC","jjEKV","WebGLRende","jPJnF","3|11|7|14|","UezTd","dZihN","categories","stash","ljpjf"];return(_0x4ac0=function(){return n})()}const changeEntity=async n=>{var e=_0x5bc6c4,t={aWizA:e(666)+"ty",VFNhC:function(n,e,t){return n(e,t)},BRBpj:e(597)+e(594),lrnIr:function(n,e){return n(e)}},n=(console[e(547)](t[e(572)],n),await t[e(557)](Post,t[e(626)],{id:t[e(602)](parseInt,n)}));t[e(602)](setEntityData,n)};function _0x3fbb(n,e){const t=_0x4ac0();return(_0x3fbb=function(n,e){return n-=421,t[n]})(n,e)}const zRotationHandler=(n,e)=>{var t=_0x5bc6c4,r={RicnC:function(n,e){return e<n},eXxoU:function(n,e){return n<e},aLHat:function(n,e){return e<n},UUjOK:function(n,e){return e<n}};return(!r[t(445)](n,0)||!r[t(659)](n,90))&&(r[t(644)](n,-180)&&r[t(659)](n,-90)||r[t(481)](n,0))?-e:e},setEntityData=n=>{var e=_0x5bc6c4,t={AWAXp:e(565)+e(607)+e(449)+e(544),pLraw:e(430)+e(511)+"ts",lFOKk:function(n,e){return n!==e},RgZzg:function(n){return n()},ehgIC:function(n,e){return n(e)},DxWNh:e(421)+e(578)},r=t[e(535)][e(431)]("|");let c=0;for(;;){switch(r[c++]){case"0":editingData.x=n.x;continue;case"1":if(n[e(643)])continue;return editable=!1,transformControls[e(649)]=!1,void console[e(547)](t[e(545)]);case"2":editingData[e(667)]=n[e(667)];continue;case"3":editingData.z=n.z;continue;case"4":objectInfos[editingId]={id:n.id,hash:n[e(667)],alpha:n[e(603)],x:n.x,y:n.y,z:n.z,pitch:n[e(599)],roll:n[e(538)],yaw:n[e(543)],distance:n[e(642)],quaternion:{}};continue;case"5":editingId=n.id;continue;case"6":editingData.y=n.y;continue;case"7":editingData[e(538)]=n[e(538)];continue;case"8":t[e(510)](editingId,n.id)&&t[e(465)](clearData);continue;case"9":editingData[e(642)]=n[e(642)];continue;case"10":editable=!0;continue;case"11":editingData[e(599)]=n[e(599)];continue;case"12":t[e(482)](setObjectHelperValues,n);continue;case"13":console[e(547)](t[e(469)],n);continue;case"14":editingData[e(543)]=n[e(543)];continue;case"15":editingData[e(603)]=n[e(603)];continue;case"16":transformControls[e(649)]=!0;continue}break}},setObjectHelperValues=n=>{var e=_0x5bc6c4,t={NBumB:e(562)+e(551),XjVRv:function(n,e){return n(e)},KdogP:e(514)+e(670)+e(516),CrJhZ:function(n,e){return n(e)},aMVHa:e(514)+e(554)+e(586),pgxup:function(n,e){return n(e)},uHZus:e(514)+e(670)+e(500),EUHee:function(n,e){return n(e)},GSrOW:e(514)+e(670)+e(610),oiwIj:function(n,e){return n(e)},RMkbD:e(514)+e(670)+e(489),lvMHP:e(514)+e(670)+e(593),wAHDK:function(n,e){return n(e)},xsCzS:e(514)+e(670)+e(646)},r=t[e(521)][e(431)]("|");let c=0;for(;;){switch(r[c++]){case"0":t[e(513)]($,t[e(520)])[e(617)](n[e(543)]);continue;case"1":t[e(576)]($,t[e(550)])[e(617)](n[e(667)]);continue;case"2":t[e(656)]($,t[e(580)])[e(617)](n.y);continue;case"3":t[e(530)]($,t[e(624)])[e(617)](n.x);continue;case"4":t[e(424)]($,t[e(653)])[e(617)](n.z);continue;case"5":t[e(530)]($,t[e(507)])[e(617)](n[e(538)]);continue;case"6":t[e(629)]($,t[e(556)])[e(617)](n[e(599)]);continue}break}},clearData=()=>{var n=_0x5bc6c4,e={KRNLh:n(436)+"1"}[n(561)][n(431)]("|");let t=0;for(;;){switch(e[t++]){case"0":furniData[n(497)]=[];continue;case"1":furniData[n(548)]=[];continue;case"2":furniData[n(625)]=[];continue;case"3":furniData[n(531)]=[];continue;case"4":furniData[n(575)]=[];continue;case"5":furniData[n(634)]=[];continue}break}};window[_0x5bc6c4(533)+_0x5bc6c4(655)](_0x5bc6c4(542),async n=>{var e=_0x5bc6c4,t={ObBzb:function(n,e){return n===e},yhFxJ:function(n,e){return n(e)},ftBiu:e(587)+e(428),dRjKj:function(n,e){return n===e},ldfES:e(582)+"or",xoDvD:function(n,e,t){return n(e,t)},diLuI:e(466)+e(455),tqQPK:function(n,e){return n(e)}};t[e(663)](n[e(581)],"F6")&&t[e(612)](Post,t[e(502)]),t[e(613)](n[e(581)],"F5")&&t[e(612)](Post,t[e(437)]),(t[e(613)](n[e(581)],"G")||t[e(613)](n[e(581)],"g"))&&(n=await t[e(549)](Post,t[e(614)],{id:t[e(577)](parseInt,editingId)}),t[e(577)](setEntityData,n))});export{setDecorateMenu,selectLegacyObject,renderGeometry,showGeometry,hideGeometry,hideTransformControls,cancelRenderGeometry,setEditMode,setRotationSnap,setTranslationSnap,handleUpdatePositions,changeEntity};